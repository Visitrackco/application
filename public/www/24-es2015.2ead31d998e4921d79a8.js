(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{aEqK:function(e,o,t){"use strict";t.r(o);var n=t("ofXK"),i=t("3Pt+"),s=t("TEn/"),a=t("tyNb"),l=t("mrSG"),c=t("tk/3"),r=t("LRne"),b=t("lJxs"),p=t("JIr8"),h=t("NIW7"),d=t("lNB8"),m=t("VOof"),u=t("w9U0"),g=t("fXoL");const f=["fileUpload"];function M(e,o){if(1&e&&g.Kb(0,"img",17),2&e){const e=g.Wb();g.cc("src",e.logo,g.ic)}}function y(e,o){if(1&e){const e=g.Nb();g.Mb(0,"ion-list"),g.Kb(1,"ion-item-divider",18),g.Mb(2,"ion-item",9),g.Mb(3,"ion-label"),g.Mb(4,"strong"),g.lc(5,"Actualizar imagen por:"),g.Lb(),g.Kb(6,"br"),g.lc(7),g.Lb(),g.Mb(8,"ion-buttons",19),g.Mb(9,"ion-button",20),g.Ub("click",(function(){return g.hc(e),g.Wb().deletedFile()})),g.Kb(10,"ion-icon",21),g.Lb(),g.Lb(),g.Lb(),g.Lb()}if(2&e){const e=o.$implicit;g.zb(7),g.oc(" ",e.data.name," - ",e.data.type," ")}}function L(e,o){if(1&e){const e=g.Nb();g.Mb(0,"ion-button",22),g.Ub("click",(function(){return g.hc(e),g.Wb().onClick()})),g.Mb(1,"div"),g.lc(2,"Cargar Imagen"),g.Lb(),g.Lb()}}function v(e,o){if(1&e){const e=g.Nb();g.Mb(0,"ion-button",23),g.Ub("click",(function(){return g.hc(e),g.Wb().uploadFiles()})),g.Mb(1,"div"),g.lc(2,"Actualizar Foto Empresa"),g.Lb(),g.Lb()}}const C=[{path:"",component:(()=>{class e{constructor(e,o,t,n,i){this.modalCtrl=e,this.storage=o,this.apiEntrena=t,this.toasCtrl=n,this.dtacompany=i,this.files=[],this.filesRendering=[],this.values={src:"",mime:"",name:""},this.logo="",this.name="",this.theme="",this.dtacompany.$color.subscribe(e=>{this.theme=e})}ngOnInit(){}ionViewWillEnter(){this.loadDataMenu()}loadDataMenu(){return Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.storage.getLogin();e&&this.apiEntrena.preferencesLoad({user:e[0].data._id},e[0].token).subscribe(e=>{console.log(e),"ok"===e.status?(this.logo=e.response.logo?"http://localhost:3000/uploads/Perfiles/"+e.response.logo:"",this.name=e.response.nameCompany?e.response.nameCompany:"VTEntrena Application",this.theme=e.response.theme?e.response.theme:"light"):(this.logo="",this.name="VTEntrena Application",this.theme="light")},e=>{this.logo="",this.name="VTEntrena Application",this.theme="light"})}))}uploadFile(e){return Object(l.a)(this,void 0,void 0,(function*(){const o=yield this.storage.getLogin();if(o){const t=new FormData;t.append("file",e.data),e.inProgress=!0,console.log(o),this.apiEntrena.uploadPreference(t,o[0].token).pipe(Object(b.a)(o=>{switch(console.log("Holaa"),o.type){case c.c.UploadProgress:e.progress=Math.round(1*o.loaded/o.total);break;case c.c.Response:return o}}),Object(p.a)(o=>(e.inProgress=!1,Object(r.a)(`${e.data.name} upload failed.`)))).subscribe(e=>{"object"==typeof e&&(console.log(e.body," Respuesta"),"ok"===e.body.status?(this.logo="http://localhost:3000/uploads/Perfiles/"+e.body.response.logo,this.dtacompany.getDataCompany({logo:"http://localhost:3000/uploads/Perfiles/"+e.body.response.logo,name:e.body.response.nameCompany?e.body.response.nameCompany:"VTEntrena Application"}),this.files=[]):this.toasCtrl.newCreatedToast("Upload failed",!1))})}}))}uploadFiles(){this.fileUpload.nativeElement.value="",this.files.forEach(e=>{this.uploadFile(e)})}onClick(){const e=this.fileUpload.nativeElement;e.onchange=()=>{for(let o=0;o<e.files.length;o++){const t=e.files[o];console.log(t,t.name),this.files.push({data:t,inProgress:!1,progress:0})}},e.click()}deletedFile(){this.files=[]}changeTheme(e){this.theme=e.detail.value}save(){return Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.storage.getLogin();e&&this.apiEntrena.preferences({name:this.name,theme:this.theme},e[0].token).subscribe(e=>{console.log(e),"ok"===e.status?(this.toasCtrl.newCreatedToast("Datos Actualizados",!0),this.name=e.response.nameCompany?e.response.nameCompany:"VTEntrena Application",this.theme=e.response.theme?e.response.theme:"light",this.dtacompany.getDataCompany({logo:"http://localhost:3000/uploads/Perfiles/"+e.response.logo,name:e.response.nameCompany?e.response.nameCompany:"VTEntrena Application"}),this.dtacompany.setColor(this.theme)):(this.toasCtrl.newCreatedToast("No se pudo actualizar la informaci\xf3n",!1),this.theme="light",this.name="VTEntrena Application")},e=>{this.toasCtrl.newCreatedToast("No se pudo actualizar la informaci\xf3n",!1),this.theme="light",this.name="VTEntrena Application"})}))}}return e.\u0275fac=function(o){return new(o||e)(g.Jb(s.Y),g.Jb(m.a),g.Jb(h.a),g.Jb(u.a),g.Jb(d.a))},e.\u0275cmp=g.Db({type:e,selectors:[["app-preferences"]],viewQuery:function(e,o){var t;1&e&&g.pc(f,!0),2&e&&g.gc(t=g.Vb())&&(o.fileUpload=t.first)},decls:44,vars:6,consts:[[3,"color"],["color","light"],[2,"margin-top","10px"],["class","img","alt","",3,"src",4,"ngIf"],[4,"ngFor","ngForOf"],["class","myButton","mode","ios","color","tertiary",3,"click",4,"ngIf"],["class","myButton","mode","ios","color","success",3,"click",4,"ngIf"],["type","file","id","fileUpload","name","file","accept","image/*","multiple","false",2,"display","none"],["fileUpload",""],[1,"marginBottom"],["type","text",3,"ngModel","ngModelChange"],["value","Rojo","okText","Aceptar","cancelText","Cancelar",3,"ionChange"],["value","danger"],["value","success"],["value","warning"],["value","primary"],["expand","block","mode","ios","color","light",1,"myButton",3,"click"],["alt","",1,"img",3,"src"],["color","warning"],["slot","end"],[3,"click"],["name","trash","color","danger","slot","icon-only"],["mode","ios","color","tertiary",1,"myButton",3,"click"],["mode","ios","color","success",1,"myButton",3,"click"]],template:function(e,o){1&e&&(g.Mb(0,"ion-header"),g.Mb(1,"ion-toolbar",0),g.Mb(2,"ion-title"),g.lc(3,"Preferencias"),g.Lb(),g.Lb(),g.Lb(),g.Mb(4,"ion-content"),g.Mb(5,"ion-item-divider",1),g.Mb(6,"ion-label"),g.Mb(7,"strong"),g.lc(8,"Foto de Empresa"),g.Lb(),g.Lb(),g.Lb(),g.Mb(9,"div"),g.Mb(10,"div",2),g.kc(11,M,1,1,"img",3),g.kc(12,y,11,2,"ion-list",4),g.Mb(13,"div"),g.kc(14,L,3,0,"ion-button",5),g.kc(15,v,3,0,"ion-button",6),g.Lb(),g.Lb(),g.Kb(16,"input",7,8),g.Lb(),g.Mb(18,"ion-list"),g.Mb(19,"ion-item-divider",1),g.Mb(20,"ion-label"),g.Mb(21,"strong"),g.lc(22,"Informaci\xf3n"),g.Lb(),g.Lb(),g.Lb(),g.Mb(23,"ion-item-divider",9),g.Mb(24,"ion-label"),g.Mb(25,"strong"),g.lc(26,"Nombre de Empresa"),g.Lb(),g.Lb(),g.Mb(27,"ion-input",10),g.Ub("ngModelChange",(function(e){return o.name=e})),g.Lb(),g.Lb(),g.Mb(28,"ion-item",9),g.Mb(29,"ion-label"),g.Mb(30,"strong"),g.lc(31,"Tema Color"),g.Lb(),g.Lb(),g.Mb(32,"ion-select",11),g.Ub("ionChange",(function(e){return o.changeTheme(e)})),g.Mb(33,"ion-select-option",12),g.lc(34,"Rojo"),g.Lb(),g.Mb(35,"ion-select-option",13),g.lc(36,"Verde"),g.Lb(),g.Mb(37,"ion-select-option",14),g.lc(38,"Amarillo"),g.Lb(),g.Mb(39,"ion-select-option",15),g.lc(40,"Azul"),g.Lb(),g.Lb(),g.Lb(),g.Lb(),g.Mb(41,"ion-button",16),g.Ub("click",(function(){return o.save()})),g.Mb(42,"div"),g.lc(43,"Guardar Cambios"),g.Lb(),g.Lb(),g.Lb()),2&e&&(g.zb(1),g.cc("color",o.theme),g.zb(10),g.cc("ngIf",""!==o.logo),g.zb(1),g.cc("ngForOf",o.files),g.zb(2),g.cc("ngIf",0===o.files.length),g.zb(1),g.cc("ngIf",o.files.length>0),g.zb(12),g.cc("ngModel",o.name))},directives:[s.s,s.T,s.S,s.l,s.w,s.A,n.i,n.h,s.B,s.u,s.fb,i.c,i.d,s.v,s.L,s.eb,s.M,s.g,s.h,s.t],styles:[".img[_ngcontent-%COMP%]{width:100%;max-width:500px;text-align:center;padding:10px}"]}),e})()}];let k=(()=>{class e{}return e.\u0275mod=g.Hb({type:e}),e.\u0275inj=g.Gb({factory:function(o){return new(o||e)},imports:[[a.i.forChild(C)],a.i]}),e})();t.d(o,"PreferencesPageModule",(function(){return w}));let w=(()=>{class e{}return e.\u0275mod=g.Hb({type:e}),e.\u0275inj=g.Gb({factory:function(o){return new(o||e)},imports:[[n.b,i.a,s.U,k]]}),e})()}}]);